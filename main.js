(()=>{"use strict";var e={baseUrl:"https://mesto.nomoreparties.co/v1/wff-cohort-2",headers:{authorization:"25acbbe0-12c1-426d-be21-ec07addb3936","Content-Type":"application/json"}},t=function(){return fetch("".concat(e.baseUrl,"/users/me"),{headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))},n=function(t){return fetch("".concat(e.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:e.headers,body:JSON.stringify({avatar:t})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))},r=function(t){return fetch("".concat(e.baseUrl,"/cards"),{method:"POST",headers:e.headers,body:JSON.stringify({name:t.name,link:t.link})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))};function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=function(e,t,n,r,c){var a=document.querySelector("#card-template").content.cloneNode(!0);if(a.querySelector(".card__title").textContent=e.name,a.querySelector(".card__image").src=e.link,a.querySelector(".card__image").alt=e.name,e.likes.length){a.querySelector(".card__like-count").textContent=e.likes.length,a.querySelector(".card__like-count").classList.add("card__like-count_is-active");var i,u=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,c=function(){};return{s:c,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(u)throw a}}}}(e.likes);try{for(u.s();!(i=u.n()).done;)i.value._id===t._id&&a.querySelector(".card__like-button").classList.add("card__like-button_is-active")}catch(e){u.e(e)}finally{u.f()}}return e.owner._id!==t._id&&a.querySelector(".card__delete-button").classList.add("card__delete-button_hidden"),a.querySelector(".card__image").addEventListener("click",(function(){c(e)})),a.querySelector(".card__delete-button").addEventListener("click",(function(t){n(t,e)})),a.querySelector(".card__like-button").addEventListener("click",(function(t){r(t,e)})),a},a=function(t,n){var r,o=t.target,c=t.target.closest(".card__like-block").querySelector(".card__like-count");o.classList.contains("card__like-button_is-active")?function(t){return fetch("".concat(e.baseUrl,"/cards/likes/").concat(t),{method:"DELETE",headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(n._id).then((function(e){o.classList.remove("card__like-button_is-active"),e.likes.length?c.textContent=e.likes.length:c.classList.remove("card__like-count_is-active")})):(r=n._id,fetch("".concat(e.baseUrl,"/cards/likes/").concat(r),{method:"PUT",headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){o.classList.add("card__like-button_is-active"),c.classList.add("card__like-count_is-active"),c.textContent=e.likes.length})).catch((function(e){console.log(e)}))},i=function(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",l)},u=function(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",l)},l=function(e){if("Escape"===e.key){var t=document.querySelector(".popup_is-opened");u(t)}},s=function(e,t,n){var r=e.querySelector(".".concat(t.name,"-error"));t.classList.remove(n.inputErrorClass),r.classList.remove(n.errorClass),r.textContent=""},d=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,t.classList.remove(n.inactiveButtonClass)):(t.disabled=!0,t.classList.add(n.inactiveButtonClass))},f=function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);d(n,r,t),n.forEach((function(n){s(e,n,t)}))};function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,c,a,i=[],u=!0,l=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _,y=document.querySelector(".places__list"),v=document.querySelector(".profile__title"),h=document.querySelector(".profile__description"),b=document.querySelector(".profile__image"),S=document.querySelectorAll(".popup"),k=document.querySelectorAll(".popup__close"),g=document.querySelector(".popup_type_edit"),q=document.querySelector(".profile__edit-button"),E=document.forms["edit-profile"],L=E.elements.name,C=E.elements.description,j=document.querySelector(".popup_type_change-avatar"),A=document.forms["new-avatar"],w=A.elements.link,x=document.querySelector(".popup_type_new-card"),P=document.querySelector(".profile__add-button"),U=document.forms["new-place"],T=U.elements["place-name"],O=U.elements.link,D=document.querySelector(".popup_type_delete-card"),B=document.querySelector(".popup_type_image"),I=document.querySelector(".popup__image"),M=document.querySelector(".popup__caption"),N={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},H=function(e,t){e.querySelector(".popup__button").textContent=t?"Сохранение...":"Сохранить"},J=function(t,n){var r=D.querySelector(".popup__button");i(D),r.addEventListener("click",(function(){var r;u(D),(r=n._id,fetch("".concat(e.baseUrl,"/cards/").concat(r),{method:"DELETE",headers:e.headers}).then((function(e){if(!e.ok)return Promise.reject("Ошибка: ".concat(e.status))}))).then((function(){t.target.closest(".card").remove()})).catch((function(e){console.log(e)}))}))},V=function(e){i(B),I.src=e.link,I.alt=e.name,M.textContent=e.name};t().then((function(e){v.textContent=e.name,h.textContent=e.about,b.setAttribute("style","background-image: url(".concat(e.avatar,");"))})).catch((function(e){console.log(e)})),Promise.all([t(),fetch("".concat(e.baseUrl,"/cards"),{headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))]).then((function(e){var t=p(e,2),n=t[0];t[1].forEach((function(e){!function(e,t,n,r,o){var a=c(e,t,n,r,o);y.append(a)}(e,n,J,a,V)}))})).catch((function(e){console.log(e)})),k.forEach((function(e){e.addEventListener("click",(function(e){var t=e.target.closest(".popup");u(t)}))})),S.forEach((function(e){e.addEventListener("click",(function(t){!function(e,t){e.currentTarget===e.target&&u(t)}(t,e)}))})),q.addEventListener("click",(function(){L.value=v.textContent,C.value=h.textContent,f(E,N),i(g)})),E.addEventListener("submit",(function(t){t.preventDefault();var n={name:L.value,about:C.value};H(g,!0),function(t){return fetch("".concat(e.baseUrl,"/users/me"),{method:"PATCH",headers:e.headers,body:JSON.stringify({name:t.name,about:t.about})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(n).then((function(e){v.textContent=e.name,h.textContent=e.about,u(g)})).catch((function(e){console.log(e)})).finally((function(){H(g,!1)}))})),P.addEventListener("click",(function(){i(x)})),U.addEventListener("submit",(function(e){e.preventDefault();var n={name:T.value,link:O.value};H(x,!0),Promise.all([t(),r(n)]).then((function(e){var t=p(e,2),n=t[0],r=t[1],o=c(r,n,J,a,V);y.prepend(o),u(x),U.reset(),f(U,N)})).catch((function(e){console.log(e)})).finally((function(){H(x,!1)}))})),b.addEventListener("click",(function(){i(j)})),A.addEventListener("submit",(function(e){var t;e.preventDefault(),H(j,!0),Promise.all([(t=w.value,fetch("".concat(t),{method:"HEAD"}).then((function(e){if(!e.headers.get("Content-Type").includes("image"))return Promise.reject("Ошибка: ".concat(e.status))}))),n(w.value)]).then((function(e){var t=e[1];b.setAttribute("style","background-image: url(".concat(t.avatar,");")),u(j),A.reset(),f(A,N)})).catch((function(e){console.log(e)})).finally((function(){H(j,!1)}))})),_=N,Array.from(document.querySelectorAll(_.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);d(n,r,t),n.forEach((function(o){o.addEventListener("input",(function(){!function(e,t,n){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?s(e,t,n):function(e,t,n,r){var o=e.querySelector(".".concat(t.name,"-error"));t.classList.add(r.inputErrorClass),o.textContent=n,o.classList.add(r.errorClass)}(e,t,t.validationMessage,n)}(e,o,t),d(n,r,t)}))}))}(e,_)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGtCQUFtQjdFLEVBSTlFLENBMEJNOEUsQ0FBUWhGLEVBQWFDLEVBQWNDLEdBQ25DSSxFQUFrQkMsRUFBV0MsRUFBZU4sRUFDOUMsR0FDRixHQUNGLENBU0krRSxDQUFrQmpGLEVBQWFFLEVBQ2pDLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWZmLy4vc3JjL3NjcmlwdHMvYXBpLmpzIiwid2VicGFjazovL21lc3RvLXByb2plY3QtZmYvLi9zcmMvc2NyaXB0cy9jYXJkLmpzIiwid2VicGFjazovL21lc3RvLXByb2plY3QtZmYvLi9zcmMvc2NyaXB0cy9tb2RhbC5qcyIsIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWZmLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWZmLy4vc3JjL3NjcmlwdHMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgY29uZmlnID0ge1xyXG4gIGJhc2VVcmw6ICdodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvd2ZmLWNvaG9ydC0yJyxcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiAnMjVhY2JiZTAtMTJjMS00MjZkLWJlMjEtZWMwN2FkZGIzOTM2JyxcclxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBnZXRVc2VyRGF0YSA9ICgpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnNcclxuICB9KVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKClcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBjaGFuZ2VVc2VyRGF0YSA9ICh1c2VyRGF0YSkgPT4ge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgbmFtZTogdXNlckRhdGEubmFtZSxcclxuICAgICAgYWJvdXQ6IHVzZXJEYXRhLmFib3V0XHJcbiAgICB9KVxyXG4gIH0pXHJcbiAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgY2hhbmdlVXNlckF2YXRhciA9IChsaW5rSW1hZ2UpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICBhdmF0YXI6IGxpbmtJbWFnZVxyXG4gICAgfSlcclxuICB9KVxyXG4gICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNoZWNrSW1hZ2VVcmwgPSAobGlua0ltYWdlKSA9PiB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2xpbmtJbWFnZX1gLCB7XHJcbiAgICBtZXRob2Q6ICdIRUFEJyxcclxuICB9KVxyXG4gICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgaWYgKCFyZXMuaGVhZGVycy5nZXQoJ0NvbnRlbnQtVHlwZScpLmluY2x1ZGVzKCdpbWFnZScpKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBnZXRJbml0aWFsQ2FyZHMgPSAoKSA9PiB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXHJcbiAgfSlcclxuICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBzZW5kTmV3Q2FyZCA9IChjYXJkRGF0YSkgPT4ge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICBuYW1lOiBjYXJkRGF0YS5uYW1lLFxyXG4gICAgICBsaW5rOiBjYXJkRGF0YS5saW5rXHJcbiAgICB9KVxyXG4gIH0pXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGRlbGV0ZUN1cnJlbnRDYXJkID0gKGNhcmRJZCkgPT4ge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXHJcbiAgfSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKCFyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHB1dExpa2UgPSAoY2FyZElkKSA9PiB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnNcclxuICB9KVxyXG4gICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGRlbGV0ZUxpa2UgPSAoY2FyZElkKSA9PiB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnNcclxuICB9KVxyXG4gICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxufVxyXG4iLCJpbXBvcnQgeyBwdXRMaWtlLCBkZWxldGVMaWtlIH0gZnJvbSBcIi4vYXBpXCI7XHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlQ2FyZCA9IChjYXJkRGF0YSwgdXNlckRhdGEsINGBYWxsYmFja0ZvclJlbW92ZSwg0YFhbGxiYWNrRm9yTGlrZSwg0YFhbGxiYWNrRm9yU2hvd0ltYWdlKSA9PiB7XHJcbiAgY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NhcmQtdGVtcGxhdGUnKS5jb250ZW50O1xyXG4gIGNvbnN0IG5ld0NhcmQgPSBjYXJkVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICBuZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX190aXRsZScpLnRleHRDb250ZW50ID0gY2FyZERhdGEubmFtZTtcclxuICBuZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWFnZScpLnNyYyA9IGNhcmREYXRhLmxpbms7XHJcbiAgbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1hZ2UnKS5hbHQgPSBjYXJkRGF0YS5uYW1lO1xyXG5cclxuICBpZiAoY2FyZERhdGEubGlrZXMubGVuZ3RoKSB7XHJcbiAgICBuZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWNvdW50JykudGV4dENvbnRlbnQgPSBjYXJkRGF0YS5saWtlcy5sZW5ndGg7XHJcbiAgICBuZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWNvdW50JykuY2xhc3NMaXN0LmFkZCgnY2FyZF9fbGlrZS1jb3VudF9pcy1hY3RpdmUnKTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IG93bmVyTGlrZSBvZiBjYXJkRGF0YS5saWtlcykge1xyXG4gICAgICBpZiAob3duZXJMaWtlWydfaWQnXSA9PT0gdXNlckRhdGFbJ19pZCddKSB7XHJcbiAgICAgICAgbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idXR0b24nKS5jbGFzc0xpc3QuYWRkKCdjYXJkX19saWtlLWJ1dHRvbl9pcy1hY3RpdmUnKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaWYgKGNhcmREYXRhLm93bmVyWydfaWQnXSAhPT0gdXNlckRhdGFbJ19pZCddKSB7XHJcbiAgICBuZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZWxldGUtYnV0dG9uJykuY2xhc3NMaXN0LmFkZCgnY2FyZF9fZGVsZXRlLWJ1dHRvbl9oaWRkZW4nKTtcclxuICB9XHJcblxyXG4gIG5ld0NhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltYWdlJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICDRgWFsbGJhY2tGb3JTaG93SW1hZ2UoY2FyZERhdGEpO1xyXG4gIH0pO1xyXG4gIG5ld0NhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idXR0b24nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldnQpID0+IHtcclxuICAgINGBYWxsYmFja0ZvclJlbW92ZShldnQsIGNhcmREYXRhKTtcclxuICB9KTtcclxuICBuZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWJ1dHRvbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4ge1xyXG4gICAg0YFhbGxiYWNrRm9yTGlrZShldnQsIGNhcmREYXRhKTtcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIG5ld0NhcmQ7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBsaWtlQ2FyZCA9IChldnQsIGNhcmREYXRhKSA9PiB7XHJcbiAgY29uc3QgbGlrZUJ1dHRvbiA9IGV2dC50YXJnZXQ7XHJcbiAgY29uc3QgbGlrZUNvdW50ID0gZXZ0LnRhcmdldC5jbG9zZXN0KCcuY2FyZF9fbGlrZS1ibG9jaycpLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWNvdW50Jyk7XHJcblxyXG4gIGlmICghbGlrZUJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2NhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZScpKSB7XHJcbiAgICBwdXRMaWtlKGNhcmREYXRhWydfaWQnXSlcclxuICAgICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgIGxpa2VCdXR0b24uY2xhc3NMaXN0LmFkZCgnY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlJyk7XHJcbiAgICAgICAgbGlrZUNvdW50LmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2xpa2UtY291bnRfaXMtYWN0aXZlJyk7XHJcbiAgICAgICAgbGlrZUNvdW50LnRleHRDb250ZW50ID0gcmVzdWx0Lmxpa2VzLmxlbmd0aDtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICB9KTtcclxuICB9IGVsc2Uge1xyXG4gICAgZGVsZXRlTGlrZShjYXJkRGF0YVsnX2lkJ10pXHJcbiAgICAgIC50aGVuKChyZXN1bHQpID0+IHtcclxuICAgICAgICBsaWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2NhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZScpO1xyXG4gICAgICAgIGlmIChyZXN1bHQubGlrZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICBsaWtlQ291bnQudGV4dENvbnRlbnQgPSByZXN1bHQubGlrZXMubGVuZ3RoO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsaWtlQ291bnQuY2xhc3NMaXN0LnJlbW92ZSgnY2FyZF9fbGlrZS1jb3VudF9pcy1hY3RpdmUnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgfVxyXG59IiwiY29uc3Qgb3Blbk1vZGFsID0gKHBvcHVwKSA9PiB7XHJcbiAgcG9wdXAuY2xhc3NMaXN0LmFkZCgncG9wdXBfaXMtb3BlbmVkJyk7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGNsb3NlTW9kYWxPbkVzY1ByZXNzKTtcclxufVxyXG5cclxuY29uc3QgY2xvc2VNb2RhbCA9IChwb3B1cCkgPT4ge1xyXG4gIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX2lzLW9wZW5lZCcpO1xyXG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBjbG9zZU1vZGFsT25Fc2NQcmVzcyk7XHJcbn1cclxuXHJcbmNvbnN0IGNsb3NlTW9kYWxPbkVzY1ByZXNzID0gKGV2dCkgPT4ge1xyXG4gIGlmIChldnQua2V5ID09PSAnRXNjYXBlJykge1xyXG4gICAgY29uc3Qgb3BlbmVkUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfaXMtb3BlbmVkJyk7XHJcbiAgICBjbG9zZU1vZGFsKG9wZW5lZFBvcHVwKTtcclxuICB9XHJcbn1cclxuXHJcbmNvbnN0IGNsb3NlTW9kYWxPbkJhY2tkcm9wQ2xpY2sgPSAoZXZ0LCBwb3B1cCkgPT4ge1xyXG4gIGlmIChldnQuY3VycmVudFRhcmdldCA9PT0gZXZ0LnRhcmdldCkgY2xvc2VNb2RhbChwb3B1cCk7XHJcbn1cclxuXHJcbmV4cG9ydCB7IG9wZW5Nb2RhbCwgY2xvc2VNb2RhbCwgY2xvc2VNb2RhbE9uQmFja2Ryb3BDbGljayB9IiwiY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlLCBmb3JtRGF0YSkgPT4ge1xyXG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5uYW1lfS1lcnJvcmApO1xyXG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKGZvcm1EYXRhLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKGZvcm1EYXRhLmVycm9yQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgZm9ybURhdGEpID0+IHtcclxuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQubmFtZX0tZXJyb3JgKTtcclxuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShmb3JtRGF0YS5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGZvcm1EYXRhLmVycm9yQ2xhc3MpO1xyXG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xyXG59O1xyXG5cclxuY29uc3QgaXNWYWxpZCA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBmb3JtRGF0YSkgPT4ge1xyXG4gIGlmIChpbnB1dEVsZW1lbnQudmFsaWRpdHkucGF0dGVybk1pc21hdGNoKSB7XHJcbiAgICBpbnB1dEVsZW1lbnQuc2V0Q3VzdG9tVmFsaWRpdHkoaW5wdXRFbGVtZW50LmRhdGFzZXQuZXJyb3JNZXNzYWdlKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaW5wdXRFbGVtZW50LnNldEN1c3RvbVZhbGlkaXR5KFwiXCIpO1xyXG4gIH1cclxuXHJcbiAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgIHNob3dJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSwgZm9ybURhdGEpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBmb3JtRGF0YSk7XHJcbiAgfVxyXG59O1xyXG5cclxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xyXG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICB9KVxyXG59O1xyXG5cclxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBmb3JtRGF0YSkgPT4ge1xyXG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoZm9ybURhdGEuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShmb3JtRGF0YS5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICB9XHJcbn07XHJcblxyXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChmb3JtRWxlbWVudCwgZm9ybURhdGEpID0+IHtcclxuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoZm9ybURhdGEuaW5wdXRTZWxlY3RvcikpO1xyXG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGZvcm1EYXRhLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBmb3JtRGF0YSk7XHJcblxyXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgaXNWYWxpZChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBmb3JtRGF0YSk7XHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgZm9ybURhdGEpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGZvcm1EYXRhKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoZm9ybURhdGEuZm9ybVNlbGVjdG9yKSk7XHJcblxyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcblx0XHRmb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgZm9ybURhdGEpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuY29uc3QgY2xlYXJWYWxpZGF0aW9uID0gKGZvcm1FbGVtZW50LCBmb3JtRGF0YSkgPT4ge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChmb3JtRGF0YS5pbnB1dFNlbGVjdG9yKSk7XHJcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoZm9ybURhdGEuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIFxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgZm9ybURhdGEpO1xyXG5cclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBmb3JtRGF0YSk7XHJcbiAgfSlcclxufVxyXG5cclxuZXhwb3J0IHsgZW5hYmxlVmFsaWRhdGlvbiwgY2xlYXJWYWxpZGF0aW9uIH0iLCJpbXBvcnQgJy4uL3BhZ2VzL2luZGV4LmNzcyc7XHJcblxyXG5pbXBvcnQgeyBjcmVhdGVDYXJkLCBsaWtlQ2FyZCB9IGZyb20gJy4vY2FyZC5qcyc7XHJcbmltcG9ydCB7IG9wZW5Nb2RhbCwgY2xvc2VNb2RhbCwgY2xvc2VNb2RhbE9uQmFja2Ryb3BDbGljayB9IGZyb20gJy4vbW9kYWwuanMnO1xyXG5pbXBvcnQgeyBlbmFibGVWYWxpZGF0aW9uLCBjbGVhclZhbGlkYXRpb24gfSBmcm9tICcuL3ZhbGlkYXRpb24uanMnO1xyXG5pbXBvcnQgeyBnZXRVc2VyRGF0YSwgY2hhbmdlVXNlckRhdGEsIGdldEluaXRpYWxDYXJkcywgc2VuZE5ld0NhcmQsIGRlbGV0ZUN1cnJlbnRDYXJkLCBjaGFuZ2VVc2VyQXZhdGFyLCBjaGVja0ltYWdlVXJsIH0gZnJvbSAnLi9hcGkuanMnO1xyXG5cclxuY29uc3QgY2FyZENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZXNfX2xpc3QnKTtcclxuXHJcbmNvbnN0IHVzZXJOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3RpdGxlJyk7XHJcbmNvbnN0IHVzZXJEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19kZXNjcmlwdGlvbicpO1xyXG5jb25zdCB1c2VyQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltYWdlJyk7XHJcblxyXG5jb25zdCBwb3B1cHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXAnKTtcclxuY29uc3QgYnV0dG9uc0Nsb3NlUG9wdXBzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19jbG9zZScpO1xyXG5cclxuY29uc3QgcHJvZmlsZUVkaXRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2VkaXQnKTtcclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcclxuY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gZG9jdW1lbnQuZm9ybXNbJ2VkaXQtcHJvZmlsZSddO1xyXG5jb25zdCBuYW1lSW5wdXQgPSBwcm9maWxlRWRpdEZvcm0uZWxlbWVudHMubmFtZTtcclxuY29uc3QgZGVzY3JpcHRpb25JbnB1dCA9IHByb2ZpbGVFZGl0Rm9ybS5lbGVtZW50cy5kZXNjcmlwdGlvbjtcclxuXHJcbmNvbnN0IGNoYW5nZUF2YXRhclBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfY2hhbmdlLWF2YXRhcicpO1xyXG5jb25zdCBjaGFuZ2VBdmF0YXJGb3JtID0gZG9jdW1lbnQuZm9ybXNbJ25ldy1hdmF0YXInXTtcclxuY29uc3QgY2hhbmdlQXZhdGFySW5wdXQgPSBjaGFuZ2VBdmF0YXJGb3JtLmVsZW1lbnRzLmxpbms7XHJcblxyXG5jb25zdCBhZGROZXdDYXJkUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9uZXctY2FyZCcpO1xyXG5jb25zdCBhZGROZXdDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKTtcclxuY29uc3QgYWRkTmV3Q2FyZEZvcm0gPSBkb2N1bWVudC5mb3Jtc1snbmV3LXBsYWNlJ107XHJcbmNvbnN0IGNhcmROYW1lSW5wdXQgPSBhZGROZXdDYXJkRm9ybS5lbGVtZW50c1sncGxhY2UtbmFtZSddO1xyXG5jb25zdCBjYXJkbGlua0lucHV0ID0gYWRkTmV3Q2FyZEZvcm0uZWxlbWVudHMubGluaztcclxuXHJcbmNvbnN0IGRlbGV0ZUNhcmRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2RlbGV0ZS1jYXJkJyk7XHJcblxyXG5jb25zdCBzaG93SW1hZ2VQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2ltYWdlJyk7XHJcbmNvbnN0IHBvcHVwSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJylcclxuY29uc3QgcG9wdXBJbWFnZUNhcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2NhcHRpb24nKTtcclxuXHJcbmNvbnN0IHZhbGlkYXRpb25Db25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiAnLnBvcHVwX19mb3JtJyxcclxuICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcucG9wdXBfX2J1dHRvbicsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogJ3BvcHVwX19idXR0b25fZGlzYWJsZWQnLFxyXG4gIGlucHV0RXJyb3JDbGFzczogJ3BvcHVwX19pbnB1dF90eXBlX2Vycm9yJyxcclxuICBlcnJvckNsYXNzOiAncG9wdXBfX2Vycm9yX3Zpc2libGUnXHJcbn1cclxuXHJcbmNvbnN0IHJlbmRlckNhcmQgPSAoY2FyZERhdGEsIHVzZXJEYXRhLCDRgWFsbGJhY2tGb3JSZW1vdmUsINGBYWxsYmFja0Zvckxpa2UsINGBYWxsYmFja0ZvclNob3dJbWFnZSkgPT4ge1xyXG4gIGNvbnN0IG5ld0NhcmQgPSBjcmVhdGVDYXJkKGNhcmREYXRhLCB1c2VyRGF0YSwg0YFhbGxiYWNrRm9yUmVtb3ZlLCDRgWFsbGJhY2tGb3JMaWtlLCDRgWFsbGJhY2tGb3JTaG93SW1hZ2UpO1xyXG4gIGNhcmRDb250YWluZXIuYXBwZW5kKG5ld0NhcmQpO1xyXG59XHJcblxyXG5jb25zdCByZW5kZXJMb2FkaW5nID0gKHBvcHVwLCBpc0xvYWRpbmcpID0+IHtcclxuICBjb25zdCBidXR0b25Qb3B1cCA9IHBvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnV0dG9uJyk7XHJcbiAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgYnV0dG9uUG9wdXAudGV4dENvbnRlbnQgPSAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBidXR0b25Qb3B1cC50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QuNGC0YwnO1xyXG4gIH1cclxufVxyXG5cclxuY29uc3QgZWRpdFByb2ZpbGUgPSAoZXZ0KSA9PiB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc3QgdXNlckRhdGEgPSB7XHJcbiAgICBuYW1lOiBuYW1lSW5wdXQudmFsdWUsXHJcbiAgICBhYm91dDogZGVzY3JpcHRpb25JbnB1dC52YWx1ZVxyXG4gIH1cclxuICByZW5kZXJMb2FkaW5nKHByb2ZpbGVFZGl0UG9wdXAsIHRydWUpO1xyXG4gIGNoYW5nZVVzZXJEYXRhKHVzZXJEYXRhKVxyXG4gICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICB1c2VyTmFtZS50ZXh0Q29udGVudCA9IHJlc3VsdC5uYW1lO1xyXG4gICAgICB1c2VyRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSByZXN1bHQuYWJvdXQ7XHJcbiAgICAgIGNsb3NlTW9kYWwocHJvZmlsZUVkaXRQb3B1cCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHJlbmRlckxvYWRpbmcocHJvZmlsZUVkaXRQb3B1cCwgZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmNvbnN0IGNoYW5nZUF2YXRhciA9IChldnQpID0+IHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICByZW5kZXJMb2FkaW5nKGNoYW5nZUF2YXRhclBvcHVwLCB0cnVlKTtcclxuICBQcm9taXNlLmFsbChbY2hlY2tJbWFnZVVybChjaGFuZ2VBdmF0YXJJbnB1dC52YWx1ZSksIGNoYW5nZVVzZXJBdmF0YXIoY2hhbmdlQXZhdGFySW5wdXQudmFsdWUpXSlcclxuICAgIC50aGVuKChyZXN1bHRzKSA9PiB7XHJcbiAgICAgIGNvbnN0IHVzZXJEYXRhID0gcmVzdWx0c1sxXTtcclxuICAgICAgdXNlckF2YXRhci5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgYGJhY2tncm91bmQtaW1hZ2U6IHVybCgke3VzZXJEYXRhLmF2YXRhcn0pO2ApO1xyXG4gICAgICBjbG9zZU1vZGFsKGNoYW5nZUF2YXRhclBvcHVwKTtcclxuICAgICAgY2hhbmdlQXZhdGFyRm9ybS5yZXNldCgpO1xyXG4gICAgICBjbGVhclZhbGlkYXRpb24oY2hhbmdlQXZhdGFyRm9ybSwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHJlbmRlckxvYWRpbmcoY2hhbmdlQXZhdGFyUG9wdXAsIGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5jb25zdCBhZGROZXdDYXJkID0gKGV2dCkgPT4ge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IGNhcmREYXRhID0ge1xyXG4gICAgbmFtZTogY2FyZE5hbWVJbnB1dC52YWx1ZSxcclxuICAgIGxpbms6IGNhcmRsaW5rSW5wdXQudmFsdWVcclxuICB9O1xyXG4gIHJlbmRlckxvYWRpbmcoYWRkTmV3Q2FyZFBvcHVwLCB0cnVlKTtcclxuICBQcm9taXNlLmFsbChbZ2V0VXNlckRhdGEoKSwgc2VuZE5ld0NhcmQoY2FyZERhdGEpXSlcclxuICAgIC50aGVuKChyZXN1bHQpID0+IHtcclxuICAgICAgY29uc3QgW3VzZXJEYXRhLCBjYXJkXSA9IHJlc3VsdDtcclxuICAgICAgY29uc3QgbmV3Q2FyZCA9IGNyZWF0ZUNhcmQoY2FyZCwgdXNlckRhdGEsIHJlbW92ZUNhcmQsIGxpa2VDYXJkLCBzaG93SW1hZ2UpO1xyXG4gICAgICBjYXJkQ29udGFpbmVyLnByZXBlbmQobmV3Q2FyZCk7XHJcbiAgICAgIGNsb3NlTW9kYWwoYWRkTmV3Q2FyZFBvcHVwKTtcclxuICAgICAgYWRkTmV3Q2FyZEZvcm0ucmVzZXQoKTtcclxuICAgICAgY2xlYXJWYWxpZGF0aW9uKGFkZE5ld0NhcmRGb3JtLCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcmVuZGVyTG9hZGluZyhhZGROZXdDYXJkUG9wdXAsIGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5jb25zdCByZW1vdmVDYXJkID0gKGV2dCwgY2FyZERhdGEpID0+IHtcclxuICBjb25zdCBidXR0b25FbGVtZW50ID0gZGVsZXRlQ2FyZFBvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnV0dG9uJyk7XHJcbiAgb3Blbk1vZGFsKGRlbGV0ZUNhcmRQb3B1cCk7XHJcbiAgYnV0dG9uRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgIGNsb3NlTW9kYWwoZGVsZXRlQ2FyZFBvcHVwKTtcclxuICAgIGRlbGV0ZUN1cnJlbnRDYXJkKGNhcmREYXRhWydfaWQnXSlcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGV2dC50YXJnZXQuY2xvc2VzdCgnLmNhcmQnKS5yZW1vdmUoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuY29uc3Qgc2hvd0ltYWdlID0gKGNhcmREYXRhKSA9PiB7XHJcbiAgb3Blbk1vZGFsKHNob3dJbWFnZVBvcHVwKTtcclxuICBwb3B1cEltYWdlLnNyYyA9IGNhcmREYXRhLmxpbms7XHJcbiAgcG9wdXBJbWFnZS5hbHQgPSBjYXJkRGF0YS5uYW1lO1xyXG4gIHBvcHVwSW1hZ2VDYXB0aW9uLnRleHRDb250ZW50ID0gY2FyZERhdGEubmFtZTtcclxufVxyXG5cclxuZ2V0VXNlckRhdGEoKVxyXG4gIC50aGVuKCh1c2VyRGF0YSkgPT4ge1xyXG4gICAgdXNlck5hbWUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xyXG4gICAgdXNlckRlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdXNlckRhdGEuYWJvdXQ7XHJcbiAgICB1c2VyQXZhdGFyLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBgYmFja2dyb3VuZC1pbWFnZTogdXJsKCR7dXNlckRhdGEuYXZhdGFyfSk7YCk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTtcclxuICB9KTtcclxuXHJcblByb21pc2UuYWxsKFtnZXRVc2VyRGF0YSgpLCBnZXRJbml0aWFsQ2FyZHMoKV0pXHJcbiAgLnRoZW4oKHJlc3VsdHMpID0+IHtcclxuICAgIGNvbnN0IFt1c2VyRGF0YSwgaW5pdGlhbENhcmRzXSA9IHJlc3VsdHM7XHJcbiAgICBpbml0aWFsQ2FyZHMuZm9yRWFjaCgoY2FyZCkgPT4ge1xyXG4gICAgICByZW5kZXJDYXJkKGNhcmQsIHVzZXJEYXRhLCByZW1vdmVDYXJkLCBsaWtlQ2FyZCwgc2hvd0ltYWdlKTtcclxuICAgIH0pO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgfSk7XHJcblxyXG5idXR0b25zQ2xvc2VQb3B1cHMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0KSA9PiB7XHJcbiAgICBjb25zdCBvcGVuZWRQb3B1cCA9IGV2dC50YXJnZXQuY2xvc2VzdCgnLnBvcHVwJyk7XHJcbiAgICBjbG9zZU1vZGFsKG9wZW5lZFBvcHVwKTtcclxuICB9KTtcclxufSk7XHJcblxyXG5wb3B1cHMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0KSA9PiB7XHJcbiAgICBjbG9zZU1vZGFsT25CYWNrZHJvcENsaWNrKGV2dCwgaXRlbSk7XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgbmFtZUlucHV0LnZhbHVlID0gdXNlck5hbWUudGV4dENvbnRlbnQ7XHJcbiAgZGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHVzZXJEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcclxuICBjbGVhclZhbGlkYXRpb24ocHJvZmlsZUVkaXRGb3JtLCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICBvcGVuTW9kYWwocHJvZmlsZUVkaXRQb3B1cCk7XHJcbn0pO1xyXG5cclxucHJvZmlsZUVkaXRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGVkaXRQcm9maWxlKTtcclxuXHJcbmFkZE5ld0NhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgb3Blbk1vZGFsKGFkZE5ld0NhcmRQb3B1cCk7XHJcbn0pO1xyXG5cclxuYWRkTmV3Q2FyZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgYWRkTmV3Q2FyZCk7XHJcblxyXG51c2VyQXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gIG9wZW5Nb2RhbChjaGFuZ2VBdmF0YXJQb3B1cCk7XHJcbn0pXHJcblxyXG5jaGFuZ2VBdmF0YXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGNoYW5nZUF2YXRhcik7XHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKHZhbGlkYXRpb25Db25maWcpOyJdLCJuYW1lcyI6WyJjb25maWciLCJiYXNlVXJsIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJnZXRVc2VyRGF0YSIsImZldGNoIiwiY29uY2F0IiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJjaGFuZ2VVc2VyQXZhdGFyIiwibGlua0ltYWdlIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhdmF0YXIiLCJzZW5kTmV3Q2FyZCIsImNhcmREYXRhIiwibmFtZSIsImxpbmsiLCJjcmVhdGVDYXJkIiwidXNlckRhdGEiLCLRgWFsbGJhY2tGb3JSZW1vdmUiLCLRgWFsbGJhY2tGb3JMaWtlIiwi0YFhbGxiYWNrRm9yU2hvd0ltYWdlIiwibmV3Q2FyZCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJ0ZXh0Q29udGVudCIsInNyYyIsImFsdCIsImxpa2VzIiwibGVuZ3RoIiwiY2xhc3NMaXN0IiwiYWRkIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciIsInMiLCJuIiwiZG9uZSIsInZhbHVlIiwiZXJyIiwiZSIsImYiLCJvd25lciIsImFkZEV2ZW50TGlzdGVuZXIiLCJldnQiLCJsaWtlQ2FyZCIsImNhcmRJZCIsImxpa2VCdXR0b24iLCJ0YXJnZXQiLCJsaWtlQ291bnQiLCJjbG9zZXN0IiwiY29udGFpbnMiLCJkZWxldGVMaWtlIiwicmVzdWx0IiwicmVtb3ZlIiwiY2F0Y2giLCJjb25zb2xlIiwibG9nIiwib3Blbk1vZGFsIiwicG9wdXAiLCJjbG9zZU1vZGFsT25Fc2NQcmVzcyIsImNsb3NlTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwib3BlbmVkUG9wdXAiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiZm9ybURhdGEiLCJlcnJvckVsZW1lbnQiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbGVtZW50Iiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJoYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlZCIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJjbGVhclZhbGlkYXRpb24iLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiZm9yRWFjaCIsImNhcmRDb250YWluZXIiLCJ1c2VyTmFtZSIsInVzZXJEZXNjcmlwdGlvbiIsInVzZXJBdmF0YXIiLCJwb3B1cHMiLCJidXR0b25zQ2xvc2VQb3B1cHMiLCJwcm9maWxlRWRpdFBvcHVwIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlRWRpdEZvcm0iLCJmb3JtcyIsIm5hbWVJbnB1dCIsImVsZW1lbnRzIiwiZGVzY3JpcHRpb25JbnB1dCIsImRlc2NyaXB0aW9uIiwiY2hhbmdlQXZhdGFyUG9wdXAiLCJjaGFuZ2VBdmF0YXJGb3JtIiwiY2hhbmdlQXZhdGFySW5wdXQiLCJhZGROZXdDYXJkUG9wdXAiLCJhZGROZXdDYXJkQnV0dG9uIiwiYWRkTmV3Q2FyZEZvcm0iLCJjYXJkTmFtZUlucHV0IiwiY2FyZGxpbmtJbnB1dCIsImRlbGV0ZUNhcmRQb3B1cCIsInNob3dJbWFnZVBvcHVwIiwicG9wdXBJbWFnZSIsInBvcHVwSW1hZ2VDYXB0aW9uIiwidmFsaWRhdGlvbkNvbmZpZyIsImZvcm1TZWxlY3RvciIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJyZW1vdmVDYXJkIiwic2hvd0ltYWdlIiwiYWJvdXQiLCJzZXRBdHRyaWJ1dGUiLCJhbGwiLCJyZXN1bHRzIiwiX3Jlc3VsdHMiLCJfc2xpY2VkVG9BcnJheSIsImNhcmQiLCJhcHBlbmQiLCJyZW5kZXJDYXJkIiwiaXRlbSIsImN1cnJlbnRUYXJnZXQiLCJjbG9zZU1vZGFsT25CYWNrZHJvcENsaWNrIiwicHJldmVudERlZmF1bHQiLCJjaGFuZ2VVc2VyRGF0YSIsImZpbmFsbHkiLCJfcmVzdWx0IiwicHJlcGVuZCIsInJlc2V0IiwiZ2V0IiwiaW5jbHVkZXMiLCJwYXR0ZXJuTWlzbWF0Y2giLCJzZXRDdXN0b21WYWxpZGl0eSIsImRhdGFzZXQiLCJlcnJvck1lc3NhZ2UiLCJzaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiaXNWYWxpZCIsInNldEV2ZW50TGlzdGVuZXJzIl0sInNvdXJjZVJvb3QiOiIifQ==